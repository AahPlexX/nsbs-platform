name: Cleanup Extra Courses

on:
  workflow_dispatch:

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Delete unwanted course directories
        run: |
          cd data/courses
          
          # Keep only change-management-specialist-cms
          KEEP="change-management-specialist-cms"
          
          for dir in */; do
            dirname="${dir%/}"
            if [ "$dirname" != "$KEEP" ]; then
              echo "Deleting: $dirname"
              rm -rf "$dirname"
            else
              echo "Keeping: $dirname"
            fi
          done
          
          echo "âœ… Cleanup complete"
          ls -la
      
      - name: Commit changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add -A
          git commit -m "chore: remove 47 unwanted course directories, keep only change-management-specialist-cms"
          git push
